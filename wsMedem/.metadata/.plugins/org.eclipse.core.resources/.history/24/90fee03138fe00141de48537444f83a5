<%@page session="true"%>
<%@ taglib uri="http://www.springframework.org/tags" prefix="spring" %>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@taglib uri="http://www.springframework.org/tags/form" prefix="form"%>
<!DOCTYPE>
    <head>
      <meta charset="utf=8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
      <script src="/medem/bootstrap/bootstrap-3.3.2-dist/js/bootstrap.min.js"></script>
      <script type='text/javascript' src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.js"></script>
	  <script type='text/javascript' src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/additional-methods.js"></script>
	  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
	  <script src="/medem/js/main_functions.js"></script>
	  <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
      <link href="/medem/bootstrap/bootstrap-3.3.2-dist/css/bootstrap.min.css" rel="stylesheet">
      <link href="/medem/css/general_layout_override.css" rel="stylesheet">
      <link href="/medem/css/custom.css" rel="stylesheet" >
      <title>MEDEM :: Empleado :: Ficha de Identificacion </title>
    </head>

    <body id="employeeShow">
 
			<jsp:include page="layouts/navigation_layout.jsp"></jsp:include>
			
			<jsp:include page="layouts/modal_layout.jsp"></jsp:include>
			
			<div class="container">
			  <div class="employeeInfo">
			  <div class="col-md-12">
			    <div class="row">
	            	<ul class="nav nav-tabs">
	                	<li class="active"><a href="#">Ficha de Identificaci&#243;n</a></li>
	                	<li><a href="/medem/familyHistory?id=${employeeId}">Ant. Heredofamiliares</a></li>
	                	<li><a href="/medem/medicalRecord?id=${employeeId}">Historia Clinica</a></li>
	                	<li><a href="/medem/medicalExam?id=${employeeId}">Examenes</a></li>
	                	<li><a href="/medem/medicalNote?id=${employeeId}">Notas</a></li>                
	              	</ul><!-- .nav nav-tabs -->
	              	
	              	<div class="tab-content">
	              	  <div class="tab-pane fade in active">
	              	    <div class="panel panel-default form">
	              	      <div class="panel-body">
	              	        <div class="col-md-3">
	              	          <div class="profile-sidebar">
	              	            <div class="profile-userpic">
	              	              <img src="http://keenthemes.com/preview/metronic/theme/assets/admin/pages/media/profile/profile_user.jpg" class="img-responsive img-circle" alt="">
	              	            </div><!-- .profile-userpic -->
	              	            <div class="profile-usertitle">
	              	              <div class="profile-usertitle-name">
								    
								  </div>
								  <div class="profile-usertitle-job">
									
								  </div>
								  <hr class="divider">
								  <div class="profile-userbuttons">
								    <div class="btn-group-vertical">
								      <a href="#" data-toggle="modal" data-target="#fileUpload" class="btn btn-success btn-sm"><span class="glyphicon glyphicon-upload"></span> Subir Foto</a>
								      <a href="/medem/editEmployee/${employeeId}" class="btn btn-warning btn-sm"><span class="glyphicon glyphicon-edit"></span> Editar</a>
								      <a href="#" data-href="/medem/deleteEmployee/${employeeId }" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#confirm-delete"><span class="glyphicon glyphicon-remove-circle"></span> Eliminar</a>
								    </div><!-- .btn-group-vertical -->
								  </div>									  
	              	            </div><!-- .profile-usertitle -->
	              	          </div><!-- .profile-sidebar -->
	              	        </div><!-- .col-med-3 -->
	              	        <div class="col-md-9">
              	              <div class="row">
								<div class="col-sm-2">
                              	  <div class="form-group" id="age">
                                    <label>Edad</label>
                                	<input name="age" type="text" class="form-control required" value="" readonly/>
                              	  </div><!-- .form-group -->                          
                              	</div><!-- .col-sm-2 -->
                     			<div class="col-sm-2">
                      			  <div class="form-group">
                         		    <label for="gender">Genero</label>
                         			<input name="gender" type="text" class="form-control" value="" readonly />
                      			  </div><!--. form-group -->                         
                    		    </div><!-- .col-sm-2 -->  
                				<div class="col-sm-4">
                  				  <div class="form-group">
                     			    <label for="maritalStatus">Estado civil</label>
                     				<input type="text" name="maritalStatus" class="form-control" value="" readonly />
                  				  </div><!--. form-group -->                         
                				</div><!-- .col-sm-4 -->   
                   				<div class="col-sm-4">
                  				  <div class="form-group">
                       			    <label for="religion">Religi&#243;n</label>
                       				<input type="text" class="form-control" name="religion" value="" readonly />
                     			  </div><!-- .form-group -->                          
                   				</div><!-- .col-sm-4 -->                 				                  		                                	               	              
              	              </div><!-- .row -->
              	              
              	              <hr class="divider"> 
              	              
              	              <div class="row">
              	                <div class="col-sm-3">
				                  <div class="form-group">
				                    <label for="bloodGroup">Grupo sanguineo:</label>
				                    <input type="text" name="bloodGroup" class="form-control" value="" readonly />
				                  </div><!--. form-group input-group -->                         
				                </div><!-- .col-sm-3 -->
	                            <div class="col-sm-3">
	                              <div class="form-group">
	                                 <label>Rh:</label>
	                                 <input type="text" name="rh" class="form-control" value="" readonly />
	                              </div><!--. form-group input-group -->                         
	                            </div><!-- .col-sm-3 --> 	
	                            <div class="col-sm-6">
	                              <div class="form-group">
	                                <label>Lugar de origen:</label>
	                                <input name="originPlace" type="text" class="form-control" value="" readonly />
	                              </div><!-- .form-group -->                          
	                            </div><!-- .col-sm-6 --> 	                            			                
              	              </div><!-- .row -->
								
              	              <hr class="divider">
              	              
              	              <div class="row">
	                            <div class="col-sm-4">
	                              <div class="form-group">
	                                <label>Domicilio:</label>
	                                <input name="address" type="text" class="form-control" id="address" value="" readonly/>
	                              </div><!-- .form-group -->                          
	                            </div><!-- .col-sm-4 -->  
	                            <div class="col-sm-3">
	                              <div class="form-group">
	                                <label>Telefono:</label>
	                                <input name="phone" type="text" class="form-control" id="phone" value="" readonly/>
	                              </div><!-- .form-group -->                          
	                            </div><!-- .col-sm-3 --> 	
	                            <div class="col-sm-3">
	                              <div class="form-group">
	                                <label>Delegaci&#243;n</label>
	                                <input name="town" type="text" class="form-control" id="town" value="" readonly/>
	                              </div><!-- .form-group -->                          
	                            </div><!-- .col-sm-3 -->
	                            <div class="col-sm-2">
	                              <div class="form-group">
	                                <label>C&#243;digo postal</label>
	                                <input name="zipCode" type="text" class="form-control" id="zipCode" value="" readonly/>
	                              </div><!-- .form-group -->                          
	                            </div><!-- .col-sm-2 -->	                                                                    	                
              	              </div><!-- .row -->
              	              
              	              <hr class="divider">
              	              
              	              <div class="row">
	                            <div class="col-sm-6">
	                              <div class="form-group">
	                                <label>Nombre de la persona de contacto:</label>
	                                <input name="contactName" type="text" class="form-control required" id="contactName" value="" readonly/>
	                              </div><!-- .form-group -->                          
	                            </div><!-- .col-sm-6 --> 
	                            <div class="col-sm-6">
	                              <div class="form-group">
	                                <label>Telefono de la persona de contacto:</label>
	                                <input name="contactPhone" type="text" class="form-control required" id="contactPhone" value="" readonly/>
	                              </div><!-- .form-group -->                          
	                            </div><!-- .col-sm-6 --> 	                                          	              
              	              </div><!-- .row -->
              	              
	              	        </div><!-- .col-md-9 -->
	              	      </div><!-- .panel-body -->
	              	    </div><!-- panel panel-default form -->
	              	  </div><!-- .tab-pane fade in active -->
	              	</div><!-- .tab-content -->
	              				      
			    </div><!-- .row -->
			  </div><!-- .col-md-12 -->
			  </div><!-- .employeeInfo -->
			</div><!-- .container -->   

			<div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			  <div class="modal-dialog">
			    <div class="modal-content">
			      <div class="modal-header modal-header-danger">
			        Atención
			      </div>
			      <div class="modal-body">
			        ¿Está seguro que quiere eliminar el registro?
			      </div>
			      <div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
			        <a class="btn btn-danger btn-ok">Eliminar</a>
			      </div>
			    </div>
			  </div>
			</div>				   


          <div id="fileUpload" class="modal fade">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header modal-header-info">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  <h4 class="modal-title"><i class="fa fa-warning"></i> Atenci&#243;n</h4>                          
                </div><!-- .modal-header -->
                <div class="modal-body">
                	<div class="form-group">
						<form:form method="POST" id="fileUploadForm" action="/medem/saveFile?_csrf=${_csrf.token}" modelAttribute="uploadForm" enctype="multipart/form-data">
							<input type="file" name="file" />
						    <input type="hidden" name="employeeId" value="" />
						    <div class="form_divider"></div>
							<input type="submit" class="btn btn-primary btn-block" value="Subir" />
						</form:form><!--  form -->
					</div><!--  .form-group -->
                </div><!-- .modal-body -->
              </div><!-- .modal-content -->
            </div><!-- .modal-dialog -->
          </div><!-- .modal fade --> 
          
          <!-- footer -->
          <jsp:include page="layouts/footer_layout.jsp"></jsp:include>

    </body>
    
      <script>
      	$(document).ready(function(){
      		console.log("Hola");
      		$( "#fileUploadForm" ).validate({
      		  rules: {
      		    file: {
      		      required: true,
      		      extension: "jpg|gif",
      		      filesize: 1048576
      		    },
      		  	messages: {
      		    	file: "Por favor, introduzca un archivo."
      		    },
    	        wrapper: "div",
    	        errorPlacement: function(error, element) {
    	            error.appendTo( element.parent("div.form-group") )
    	            	 .addClass("alert alert-danger")
    	            	 .prepend("<span class='glyphicon glyphicon-exclamation-sign' aria-hidden='true'></span>");
    	        },
    			highlight: function (element) {
    	            $(element).closest("div").addClass('has-error');
    	        },
    	        submitHandler: function(form) { 
    	        	form.submit(); 
    	        }      		    
      		  }
      		});  
      		
			showMessage("Cargando información ...", "info", "myModal");

			$.ajax({
				dataType: "json",
				url: "${pageContext.request.contextPath}/employeeInformation",
				type: "GET",
				data: {id: 1},
				success: function(data){
					console.log(data.employeeId);
					if(data){
					  $.each(data, function(key, value){
					    console.log(key + " : " + value);
					    $("input[name='"+key+"']").val(value);
					  });
					}
					$(".profile-usertitle-name").html(data.name + " " + data.lastName1 + " " + data.lastName2);
					$(".profile-usertitle-job").html(data.areaName);
					$("#employeeShow .container .employeeInfo").fadeIn("slow");
					$("#myModal").modal("hide");
				},
				error: function(){
					console.log("error");
				}
			});

			$("#confirm-delete").on("show.bs.modal", function(e) {
              $(this).find(".btn-ok").attr("href", $(e.relatedTarget).data("href"));
            });
      	});
      </script>    

  </html>